<main class="main">
  <h1>{{ title }}</h1>
  
  <button (click)="readTag()">Load Gun</button>
  <dialog #dialog>
    @if (dialogState === 'read') {
      Tap your NFC chip to load gun
    } @else {
      Tap to save your gun to an NFC Chip
    }
    <p #loadedGun></p>
    <button (click)="closeDialog()">X</button>
  </dialog>
  <button (click)="writeTag()">Save Gun</button>

  <br><br>
  <button (click)="generateNewGun()">Generate!</button>
  <br><br>
  <label for="level">Level</label>
  <input id="level" type="number" min="1" max="30" [defaultValue]="1" #level />

  <form [formGroup]="gunForm" (ngSubmit)="onSubmit()" *ngIf="gunTypeRoll === 8 || (gunTypeRoll === 7 && gunGuildRoll === 8)">
    <p>Select Favored Gun </p>
    <label for="type">Type</label>
    <select id="type" #type formControlName="type">
      <option value="Pistol">Pistol</option>
      <option value="Submachine Gun">Submachine Gun</option>
      <option value="Shotgun">Shotgun</option>
      <option value="Combat Rifle">Combat Rifle</option>
      <option value="Sniper Rifle">Sniper Rifle</option>
      <option value="Rocket Launcher">Rocket Launcher</option>
    </select>
    <label for="guild">Guild</label>
    <select id="guild" #guild formControlName="guild">
      <option value="Alas!">Alas!</option>
      <option value="Skuldugger">Skuldugger</option>
      <option value="Dahlia">Dahlia</option>
      <option value="Blackpowder">Blackpowder</option>
      <option value="Malefactor">Malefactor</option>
      <option value="Hyperius">Hyperius</option>
      <option value="Feriore">Feriore</option>
      <option value="Torgue">Torgue</option>
      <option value="Stoker">Stoker</option>
    </select>
    <button type="submit">Submit</button>
  </form>
  <p *ngIf="!!level && !!gunRarity && !!gunGuild && !!gunType">{{ level.value }} {{ gunRarity !== 'legendary' ? gunPrefix : '' }} {{ gunRarity | titlecase }} {{ gunGuild }} {{ gunType }}</p>

</main>

<bnb-gun-card [level]="getLevel(level.value)" [type]="gunType" [guild]="gunGuild" [rarity]="gunRarity" [element]="gunElement" [prefix]="gunPrefix" id="gunCard"/>
<hr>
<h2>History</h2>
<bnb-history-list [data]="gunList" (loadGun)="loadGun($event)"/>
<hr>
<h4>Log</h4>
<button (click)="clearLog()">Clear Logs</button>
<p id="log" #log></p>
<router-outlet></router-outlet>
